# Rime schem
# Rime schema
# encoding: utf-8

schema:
  schema_id: flypy_xhfast
  name: é£é¹¤å¿«æ‹¼
  version: "0.4"
  author:
    - boomker
  description: |
    å°é¹¤åŒæ‹¼+è¾…åŠ©ç 
  dependencies:
    # - flypy_phrase  # ä¸­æ–‡è¯åº“ - ç°ä»£æ±‰è¯­è¯å…¸ & æ¸…åå¼€æºè¯åº“
    - melt_eng      # è‹±æ–‡å•è¯&è¯ç»„ - ç®€æ˜è‹±æ±‰è¯å…¸(å¢å¼ºç‰ˆ)
    - easy_en
    # - emoji
    # - stroke

switches:
  - name: ascii_mode
    reset: 0
    states: [ä¸­æ–‡, è¥¿æ–‡]
  - name: ascii_punct
    reset: 0
    states: [ã€‚, .]
  - name: emoji
    reset: 1
    states: [ ğŸ’€, ğŸ˜„ ]
  - name: full_shape
    states: [åŠè§’, å…¨è§’]
  - name: simplification
    reset: 1
    states: [æ¼¢å­—, æ±‰å­—]
  - options: ["utf8", "gbk", "gb2312"] # å­—ç¬¦é›†é€‰å•
    reset: 0 # é»˜è®¤ UTF8
    states:
      - UTF-8
      - GBK
      - GB2312

engine:
  processors:
    - lua_processor@easy_cmd_processor
    - lua_processor@select_char_processor
    - lua_processor@cold_word_drop_processor
    - lua_processor@word_append_space_processor
    - lua_processor@top_word_autocommit_processor
    - ascii_composer
    - recognizer
    - key_binder
    - speller
    - punctuator
    - selector
    - navigator
    - express_editor
  segmentors:
    - ascii_segmentor
    - matcher
    - abc_segmentor
    - punct_segmentor
    - affix_segmentor@mkst
    - affix_segmentor@chinese_number
    - affix_segmentor@easy_en_simp
    - affix_segmentor@laTeX_formula
    - affix_segmentor@dbpy_flypy_help
    - fallback_segmentor
  translators:
    - punct_translator
    - reverse_lookup_translator
    - script_translator
    - table_translator@mkst                       # ç²¾å‡†é€ è¯
    # - history_translator@history
    # - table_translator@flypy_phrase
    - table_translator@custom_phrase
    - table_translator@idiom_phrase
    # - table_translator@emojis
    - table_translator@melt_eng
    - table_translator@easy_en_simp               # oy è§¦å‘å•è¯è¾“å…¥
    - table_translator@dbpy_flypy_help            # oh è§¦å‘
    - lua_translator@commit_history_translator    # hisz è§¦å‘
    - lua_translator@datetime_translator          # date, rq, week, time è§¦å‘
    - lua_translator@lunar_translator
    - lua_translator@en_custom_translator         # `å°¾è§¦å‘
    - lua_translator@laTex_translator             # tf è§¦å‘
    - lua_translator@number_translator            # n/ è§¦å‘
    - lua_translator@engword_autocaps_translator  # å¤§å†™å­—æ¯å¼€å¤´è§¦å‘
    - lua_translator@top_word_autocommit_translator
  filters:
    - simplifier@emoji
    - simplifier@simplification
    - lua_filter@charset_withEmoji_filter
    - lua_filter@word_append_space_filter
    - lua_filter@engword_autocaps_filter
    - lua_filter@long_word_up_filter
    - lua_filter@top_word_autocommit_filter
    - lua_filter@cold_word_drop_filter
    - simplifier
    - uniquifier  #  åªèƒ½æ”¾åˆ°æœ€å!

speller:
  alphabet: zyxwvutsrqponmlkjihgfedcbaZYXWVUTSRQPONMLKJIHGFEDCBA_[`/
  initials: zyxwvutsrqponmlkjihgfedcbaZYXWVUTSRQPONMLKJIHGFEDCBA
  delimiter: " '"
  # max_code_length: 8
  # auto_select: true
  # auto_select_pattern: '^\w+\[\w{2}$'
  algebra:
    - erase/^ng\[kx$/ # å“åº”è¶…çº§ç®€æ‹¼ï¼Œå–æ¶ˆã€Œå—¯ ngã€çš„ç‹¬å 
    - erase/^ng\[kk$/ # å“åº”è¶…çº§ç®€æ‹¼ï¼Œå–æ¶ˆã€Œå”” ngã€çš„ç‹¬å 
    - erase/^n\[\w+$/ # å“åº”è¶…çº§ç®€æ‹¼ï¼Œå–æ¶ˆã€Œå—¯ nã€çš„ç‹¬å 
    - erase/^m\[\w+$/ # å“åº”è¶…çº§ç®€æ‹¼ï¼Œå–æ¶ˆã€Œå‘’ mã€çš„ç‹¬å 
    - erase/^m\[\w+$/ # å“åº”è¶…çº§ç®€æ‹¼ï¼Œå–æ¶ˆã€Œå‘£ mã€çš„ç‹¬å 
    # - xform/[[]//   # å–æ¶ˆæ³¨é‡Šåï¼šç›´æ¥å¼•å¯¼è¾…åŠ©ç 
    # - derive/^(..).+$/$1/
    # - derive/^(..[[].).+$/$1/

    ## å­—åº“ç¼–ç åˆ°è¾“å…¥ç çš„è½¬æ¢è§„åˆ™
    - derive/^(\w+)\[(\w)(\w)$/$1\[$2$3/ # Flypy: AB[CD
    - derive/^(\w+)\[(\w)(\w)$/$1\[$2/   # Flypy: AB[C
    - derive/^(\w+)\[(\w)(\w)$/$1/       # Flypy: AB

    ## éŸ³ç ä¼˜åŒ–è§„åˆ™,ä¸å½±å“åŸå§‹éŸ³ç è§„åˆ™, å±äºå…¨æ–°è‡ªåˆ›
    - derive/^(j)n/$1c/
    - derive/^([jyn])t/$1d/         # t --> d
    - derive/^([bjlmnx])p/$1e/      # p --> e
    - derive/^([djlnx])q/$1f/       # q --> f
    - derive/^q([biklmnrsxy])/f$1/
    - derive/^qq/fz/
    - derive/^qu/fs/
    - derive/^qp/fe/
    - derive/^qt/fd/
    - derive/^dp/dl/                # dp --> dl
    - derive/^p([okifuhjbnmg])/e$1/ # pk --> ek
    - derive/^pb/ek/
    - derive/^pc/ev/                # pc --> ev
    - derive/^pd/ef/                # pd --> ef
    - derive/^pw/es/                # pw --> es
    - derive/^([jkiu])y/$1w/        # [jk]y --> [jk]w
    - derive/^y([ikb])/w$1/         # y[ik] --> w[ik]
    - derive/^y([asderzc])/o$1/
    - derive/^yu/ov/
    - derive/^yy/ow/
    - derive/^yj/wm/
    - derive/^yh/wn/
    - derive/^hy/hw/
    - derive/^t([wy])/dw/           # t[wy] --> dw
    - derive/^t([erp])/df/          # t[er] --> df
    - derive/^tg/og/                # tg --> og
    - derive/^tk/rk/                # tk --> rk
    - derive/^rg/rb/
    - derive/^rf/rn/
    - derive/^xt/xd/
    - derive/^xl/xh/
    - derive/^xy/xo/
    - derive/^bh/sb/
    - derive/^bj/aj/
    - derive/^bu/au/
    - derive/^jx/ja/
    - derive/^jb/jo/
    - derive/^jm/jz/
    - derive/^mk/zk/
    - derive/^zw/zk/
    - derive/^vg/vk/
    - derive/^ly/nw/
    - derive/^b([fgknm])/s$1/       # b[fgknm] --> s[fgknm]
    - derive/^mb/ms/


grammar:
  language: zh-hans-t-essay-bgw

translator:
  dictionary: flypy_xhfast
  contextual_suggestions: true  # å¼€å¯å…«è‚¡æ–‡, ä¸Šä¸‹æ–‡è”æƒ³
  encode_commit_history: true   # ä¸Šå±å†å²è®°å½•
  initial_quality: 1.3
  spelling_hints: 1             ## `0`: å…³é—­å•å­—ç¼–ç æç¤º
  comment_format:
    - xform/^\w+[[](\w+)$/~$1/                   ## å•å­—ç¼–ç æç¤ºåªæ˜¾ç¤ºè¾…åŠ©ç éƒ¨åˆ†
    - xform/^~\w+\s.*$//                         ## å•å­—ç¼–ç æç¤ºåªæ˜¾ç¤ºè¾…åŠ©ç éƒ¨åˆ†
    # - xform/^\w+[[](\w+)\s\w+[[](\w+)$/~$2/      ## å•å­—ç¼–ç æç¤ºåªæ˜¾ç¤ºè¾…åŠ©ç éƒ¨åˆ†
    # - xform/^\w+\s.*$//                          ## å•å­—ç¼–ç æç¤ºåªæ˜¾ç¤ºè¾…åŠ©ç éƒ¨åˆ†

mkst:
  __include: /translator  # å¤ç”¨ä¸Šé¢çš„ç¿»è¯‘å™¨,æ—¥å¿—ä¸­å¸¦æœ‰ warning
  enable_sentence: true
  sentence_over_completion: true
  tips: "ã€”ç²¾å‡†é€ è¯ã€•"
  tag: mkst

custom_phrase:  # è‡ªå®šä¹‰çŸ­è¯­, åŒ…å«å›ºé¡¶å­—è¯, å¿«æ·å¯åŠ¨ APP åç§°
  dictionary: ""
  user_dict: custom_phrase
  db_class: stabledb
  enable_completion: false
  enable_sentence: false
  initial_quality: 9

idiom_phrase: # æˆè¯­, ä¿—è¯­ç¼©å†™, å®ç°ç®€æ‹¼
  dictionary: ""
  user_dict: idiom_phrase
  db_class: stabledb
  enable_completion: false
  enable_sentence: false
  initial_quality: -1

melt_eng: # è‹±æ–‡å•è¯
  enable_encoder: false
  encode_commit_history: false
  enable_sentence: false
  enable_completion: true # æ˜¯å¦å¯ç”¨è‹±æ–‡è¾“å…¥è”æƒ³è¡¥å…¨
  enable_user_dict: false
  dictionary: melt_eng
  initial_quality: 1.1

# flypy_phrase: # å°é¹¤éŸ³å½¢-çŸ­è¯­ï¼Œæ”¯æŒè‡ªåŠ¨è¡¥å…¨, è¯åº“æºè‡ªç°ä»£æ±‰è¯­è¯å…¸
#   enable_encoder: false
#   encode_commit_history: false
#   enable_sentence: false
#   enable_user_dict: false
#   enable_completion: true
#   dictionary: flypy_phrase
#   initial_quality: 1.2

punctuator:
  full_shape:
    __include: default:/punctuator/full_shape  # ä» default.yaml å¯¼å…¥é…ç½®
  half_shape:
    __include: default:/punctuator/half_shape  # ä» default.yaml å¯¼å…¥é…ç½®
  symbols:
    __include: symbols_v:/symbols             # ä» symbols_ox.yaml å¯¼å…¥é…ç½®
  symbols:
    "v/zb": [â”Œ, â””, â”, â”˜, â”€, â”‚, â”œ, â”¤, â”¬, â”´, â”¼, â”, â”—, â”“, â”›, â”, â”ƒ, â”£, â”«, â”³, â”», â•‹] ## åˆ¶è¡¨ç¬¦

key_binder:
  import_preset: default
  bindings:
    #- { when: composing, accept: Tab, send: '[' }        ## å–æ¶ˆæ³¨é‡Šå: tabå¼•å¯¼è¾…åŠ©ç 
    - { when: has_menu, accept: semicolon, send: 2 }
    - { when: has_menu, accept: apostrophe, send: 3 }     ## å•å¼•å·ç”¨äºç¬¬3å€™é€‰
    - { when: composing, accept: bracketleft, send: "[" } ## `[`å¼•å¯¼è¾…åŠ©ç 
    - { when: composing, accept: Control+o, send: Shift+Left }
    - { when: composing, accept: Control+i, send: Shift+Right }
    - { when: composing, accept: Control+w, send: Control+BackSpace }
    # - { when: composing, accept: Control+m, send: Return }
    ## å¯¹ä»¥ä¸‹4è¡Œå–æ¶ˆæ³¨é‡Šåï¼šå¯ç”¨å…‰æ ‡å›é€€è‡³ç‰¹å®šéŸ³èŠ‚åã€è¡¥å……è¾…åŠ©ç çš„åŠŸèƒ½
    ## ï¼ˆè‡ªç„¶ç ç­‰å…¶ä»–åŒæ‹¼ç”¨æˆ·è¯·åœ¨ pinyin_switch.yaml ä¸­è®¾ç½®ï¼‰
    #- { when: always, accept: Control+1, send_sequence: 'HelloWorld' }

recognizer:
  # import_preset: default
  patterns:
    # uppercase: "^[A-Z]+$"
    punct: '^v/([0-9]0?|[A-Za-z]+)$'
    chinese_number: '^n/[0-9]+$'
    mkst: "^[a-z]+[[][a-z[[]]*$"     # `[` å¼•å¯¼ ç²¾å‡†é€ è¯
    ## associate schemes:
    reverse_lookup: "^oq[a-z]*?$"    # éƒ¨ä»¶æ‹†å­—ï¼Œéƒ¨ä»¶ä½¿ç”¨å°é¹¤åŒæ‹¼ç¼–ç 
    dbpy_flypy_help: "^oh.*$"
    easy_en_simp: "^oy[a-z]*$"
    # emojis: "^Of[a-z]*'?$"
    laTeX_formula: "^tf(.*)$"

menu:
  page_size: 5

simplification:
  option_name: simplification
  opencc_config: t2s.json
  tags: abc
  tips: none
  excluded_types: [ reverse_lookup ]

# Emoji
emoji:
  option_name: emoji
  opencc_config: emoji.json

# emojis:
#   tag: emojis
#   dictionary: emoji
#   enable_completion: true
#   prefix: "Oe"
#   suffix: "'"
#   tips: " Emoji"

chinese_number:
  tag: chinese_number
  # prefix: "n/"
  tips: " ä¸­æ–‡æ•°å­—ç®€ç¹å¤§å°å†™ "

dbpy_flypy_help:
  dictionary: ""
  user_dict: dbpy_flypy_help
  tag: dbpy_flypy_help
  prefix: "oh"
  tips: "å°é¹¤åŒæ‹¼æŸ¥é”®"
  db_class: stabledb
  enable_completion: true
  enable_sentence: false
  initial_quality: 1

easy_en_simp:
  tag: easy_en_simp
  dictionary: easy_en
  enable_completion: true
  enable_sentence: false
  enable_user_dict: false
  prefix: "oy"
  # suffix: "'"
  tips: "è‹±æ–‡å•è¯(å¯å»å…ƒéŸ³)"
  spelling_hints: 9
  comment_format:
    - xform/^.+$//

reverse_lookup:
  dictionary: flypy_chaizi
  enable_completion: true
  prefix: "oq"
  suffix: "'"
  tips: ã€”éƒ¨ä»¶ç»„å­—ã€• # ã€”ç­†ç•«ã€•
  preedit_format:
    # - xlit/hspnz/ä¸€ä¸¨ä¸¿ä¸¶ä¹™/

laTeX_formula:
  tag: laTeX_formula
  prefix: "tf"
  tips: " TeX å…¬å¼"

history: #ä¸Šå±å†å²è®°å½•
  tag: history
  history_num_max: 10
  size: 10
  input: "hisz"
  initial_quality: 1000
  excluded_type: "punct"
